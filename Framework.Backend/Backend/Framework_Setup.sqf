Framework_Server_Files = [
	['Function', 'Framework_Player'],
	['Function', 'Framework_Lib'],
	['Function', 'Framework_Message'],
	['Function', 'Framework_ATM'],
	['Function', 'Framework_Jobs'],
	['Function', 'Framework_Gear'],
	['Function', 'Framework_Config'],
	['Function', 'Framework_PlayerMenu'],
	['Function', 'Framework_Items'],
	['Function', 'Framework_Shop'],
	['Function', 'Framework_Interactions'],
	['Function', 'Framework_Vehicle'],
	['Function', 'Framework_Phone'],
	['Config', 'Config_Items'],
	['Config', 'Config_Gear'],
	['Config', 'Config_Shops'],
	['Config', 'Config_Jobs'],
	['Config', 'Config_Server'],
	['Config', 'Config_Actions'],
	['Config', 'Config_Vehicle']
];

Framework_NPCs = [
	['Framework_Shop_Food1', [12820.1,14257.4,3.32645], 260.986],
	['Framework_Shop_Truck1', [13175,15809.6,14.1642], 102.556],
	['Framework_DeliveryJob', [12647.7,14304.1,9.54545], 215.57],
	['Framework_Shop_Market1', [17020.9,12628.4,16.6866], 269.423],
	['Framework_Shop_Market2', [12533.9,14415.3,18.3748], 23.2332],
	['Framework_Shop_Boat1', [13320.3,14449.2,1.77472], 55.5266],
	['Framework_Shop_Pistol1', [14282.1,13005.6,5.56957], 316.902],
	['Framework_Shop_Clothing1', [14491.2,17598.6,22.5784], 200.595],
	['Framework_VehicleStorage1', [12396.6,14125.4,2.71806], 157.712],
	['Framework_Hospital_1', [17621,5526.66,0.214033], 39.1685],

	['Framework_PD_ItemShop', [16551.4,12782,11.4827], 30.1611],
	
	['Framework_Shop_Food2', [12397.2,15776.9,20.919], 11.71],
	['Framework_Shop_Food3', [16579.8,12462.8,2.97279], 235.225],
	
	['Framework_Shop_FishingTools1', [15409,15881.1,4.52487], 36.753],
	['Framework_Shop_MiningTools1', [16752.2,13652.8,9.71297], 72.5558],
	['Framework_Shop_Farming1', [17012.7,15223.7,21.3036], 305.618],
	['Framework_Church1', [16676.1,16123.8,18.4704], 265.336],
	['Framework_Shop_Resource1', [16955.7,15020.1,15.9145], 119.237],
	['Framework_Shop_Resource2', [12552.7,15556,23.0143], 237.084],
	['Framework_Shop_Construction1', [14673.9,18081.8,31.8533], 152.756],
	['Framework_Shop_Pistol2', [15402,11341.1,18.1966], 331.94],

	['Framework_ATM_1', [14592.7,16772.1,18.0364], 316.033],
	['Framework_ATM_2', [16931.5,15144.5,18.4926], 272.434],
	['Framework_ATM_3', [16555.9,12779.5,11.0014], 210.791],
	['Framework_ATM_4', [12532.9,14236.7,6.61905], 67.9211]
];

Framework_Markers = [
	['Framework_Shop_Food1', 'Food Shop', 'mil_dot', 'colorGreen', [0.5, 0.5]],
	['Framework_Shop_Food2', 'Food Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Food3', 'Food Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Truck1', 'Truck Shop', 'mil_dot', 'colorGreen', [0.5, 0.5]],
	['Framework_Shop_Market1', 'Market', 'mil_dot', 'colorGreen', [0.5, 0.5]],
	['Framework_Shop_Market2', 'Market', 'mil_dot', 'colorGreen', [0.5, 0.5]],
	['Framework_DeliveryJob', 'Delivery Jobs', 'mil_dot', 'colorOrange', [0.5, 0.5]],
	['Framework_Shop_Boat1', 'Boat Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Pistol1', 'Pistol Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Pistol2', 'Pistol Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_VehicleStorage1', 'Vehicle Storage', 'mil_dot', 'colorBrown', [0.5, 0.5]],
	['Framework_Hospital_1', 'Hospital', 'mil_dot', 'colorRed', [0.5, 0.5]],
	['Framework_Shop_Clothing1', 'Clothing Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Resource1', 'Resource Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Resource2', 'Resource Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_FishingTools1', 'Fishing Tools', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_MiningTools1', 'Mining Tools', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Farming1', 'Farm Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Church1', 'Church', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Resource1', 'Resource Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Resource2', 'Resource Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],
	['Framework_Shop_Construction1', 'Construction Shop', 'mil_dot', 'colorgreen', [0.5, 0.5]],

	['Framework_PD_ItemShop', 'Police Item Shop', 'mil_dot', 'colorblue', [0.5, 0.5]],

	['Framework_ATM_1', 'ATM', 'mil_dot', 'colorYellow', [0.5, 0.5]],
	['Framework_ATM_2', 'ATM', 'mil_dot', 'colorYellow', [0.5, 0.5]],
	['Framework_ATM_3', 'ATM', 'mil_dot', 'colorYellow', [0.5, 0.5]],
	['Framework_ATM_4', 'ATM', 'mil_dot', 'colorYellow', [0.5, 0.5]],

	[[14146.8,16468.5,17.0178], 'Race Track', 'mil_dot', 'colorRed', [0.5, 0.5]],
	[[16599.1,12786.1,11.0014], 'Police Station', 'mil_dot', 'colorBlue', [0.5, 0.5]]
];

Framework_Compile = {
	private ["_name", "_code", "_forServer"];

	_name = [_this, 0, '', ['']] call BIS_fnc_param;
	_code = [_this, 1] call BIS_fnc_param;
	_forServer = [_this, 2, false, [false]] call BIS_fnc_param;

	call compile format ["%1 = %2;", _name, _code];

	if(_forServer isEqualTo false) then {
		publicVariable _name;
	};
};

Framework_SetupFiles = {
	private ['_type', '_name', '_for', '_folder'];
	{
		_type = _x select 0;
		_name = _x select 1;
		_folder = '';

		if (_type isEqualTo 'Function') then {
			_folder = 'Functions';
		};

		if (_type isEqualTo 'Config') then {
			_folder = 'Configs';
		};

		if (_folder isEqualTo '') exitWith {};
			
		call compile preprocessFile format ["\Framework.Backend\%1\%2.sqf", _folder, _name];
	} forEach Framework_Server_Files;
};

Framework_SetupMarkers = {
	private ['_count', '_marker'];

	_count = 0;

	{
		_count = _count + 1;

		if ((TypeName (_x select 0)) isEqualTo 'STRING') then {
			_marker = createMarkerLocal [format['Framework_Marker_%1', _count], call compile (_x select 0)];
		} else {
			_marker = createMarkerLocal [format['Framework_Marker_%1', _count], _x select 0];
		};

		_marker setMarkerText (_x select 1);
    	_marker setMarkerType (_x select 2);
    	_marker setMarkerColor (_x select 3);
    	_marker setMarkerSize (_x select 4);
	} forEach Framework_Markers;

	Framework_MarkersSetup = true;
};

Framework_SetupNPCs = {
	private ['_npc'];

	{
		_npc = call compile (_x select 0);

		_npc switchMove '';
		_npc allowDamage false;
		_npc setDamage 0;
		_npc enableSimulation false;
		_npc setPosASL (_x select 1);
		_npc setDir (_x select 2);
	} forEach Framework_NPCs;

	Framework_NPCsSetup = true;
};


Framework_Server_Init = {
	private ['_result'];

	[] call Framework_SetupFiles;
	[] call Framework_SetupNPCs;
	waitUntil {(isNil 'Framework_NPCsSetup') isEqualTo false};
	[] call Framework_SetupMarkers;
	waitUntil {(isNil 'Framework_MarkersSetup') isEqualTo false};
	
	Framework_ServerLoaded = true;	
	publicVariable "Framework_ServerLoaded";
};